<!DOCTYPE html>
<html>
<head>
    <title>Wikipedia Changes</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>
    <div id="chart"></div>
    <script>
        fetch('/api/data')
            .then(response => response.json())
            .then(data => {
                const width = 800;
                const height = 400;
                const margin = { top: 20, right: 30, bottom: 30, left: 40 };

                const svg = d3.select('#chart').append('svg')
                    .attr('width', width + margin.left + margin.right)
                    .attr('height', height + margin.top + margin.bottom)
                    .append('g')
                    .attr('transform', `translate(${margin.left},${margin.top})`);

                const x = d3.scaleTime()
                    .domain(d3.extent(data, d => new Date(d.timestamp)))
                    .range([0, width]);

                svg.append('g')
                    .attr('transform', `translate(0,${height})`)
                    .call(d3.axisBottom(x));

                const y = d3.scaleLinear()
                    .domain([0, d3.max(data, d => d.revision_id)])
                    .range([height, 0]);

                svg.append('g')
                    .call(d3.axisLeft(y));

                svg.append('path')
                    .datum(data)
                    .attr('fill', 'none')
                    .attr('stroke', 'steelblue')
                    .attr('stroke-width', 1.5)
                    .attr('d', d3.line()
                        .x(d => x(new Date(d.timestamp)))
                        .y(d => y(d.revision_id))
                    );
            });
    </script>
</body>
</html>